import { PrismaClient, CategoriaPrefijo, EscalaType, UnidadType } from '@prisma/client';

const prisma = new PrismaClient();

async function main() {
  console.log('üì¢ Implementando indicadores C (Comunicaci√≥n y Gobernanza) - ¬°CATEGOR√çA FINAL!');

  // Buscar el proyecto existente
  const proyecto = await prisma.proyecto.findFirst();
  if (!proyecto) {
    console.error('‚ùå No se encontr√≥ ning√∫n proyecto. Ejecute primero el seed principal.');
    process.exit(1);
  }

  console.log('üìã Proyecto encontrado:', proyecto.nombre);

  // Definir los 23 indicadores C seg√∫n JSON oficial (excluyendo entradas duplicadas/categ√≥ricas)
  const indicadoresC = [
    // GOBERNANZA Y PARTICIPACI√ìN (C-101 a C-110)
    {
      codigo: 'C-101',
      categoria_prefijo: CategoriaPrefijo.C,
      indicador: 'Coordinaci√≥n multinivel con organismos competentes en el proyecto',
      escala: EscalaType.PROYECTO,
      unidad: UnidadType.NUMERO,
      origen_calculo: 'N√∫mero de organismos p√∫blicos de diferentes niveles que participan activamente en el proyecto',
      objetivos_2025: 'Establecer coordinaci√≥n con al menos 8 organismos (local, auton√≥mico, estatal)',
      observaciones: 'Incluye ayuntamiento, diputaci√≥n, comunidad aut√≥noma, ministerios, organismos aut√≥nomos',
      proyecto_id: proyecto.id,
    },
    {
      codigo: 'C-102',
      categoria_prefijo: CategoriaPrefijo.C,
      indicador: 'Participaci√≥n-colaboraci√≥n de agentes clave en proyecto',
      escala: EscalaType.PROYECTO,
      unidad: UnidadType.NUMERO,
      origen_calculo: 'N√∫mero de entidades privadas, ONGs, asociaciones y agentes sociales colaboradores',
      objetivos_2025: 'Involucrar 15 agentes clave del territorio en el proyecto',
      observaciones: 'Incluye empresas locales, asociaciones vecinales, ONGs ambientales, centros educativos',
      proyecto_id: proyecto.id,
    },
    {
      codigo: 'C-103',
      categoria_prefijo: CategoriaPrefijo.C,
      indicador: 'Participaci√≥n ciudadana activa al amparo del proyecto',
      escala: EscalaType.PROYECTO,
      unidad: UnidadType.NUMERO,
      origen_calculo: 'N√∫mero de ciudadanos que participan activamente en actividades del proyecto',
      objetivos_2025: 'Lograr participaci√≥n activa de 500 ciudadanos',
      observaciones: 'Incluye talleres, reuniones, jornadas, actividades de voluntariado ambiental',
      proyecto_id: proyecto.id,
    },
    {
      codigo: 'C-104',
      categoria_prefijo: CategoriaPrefijo.C,
      indicador: 'Recogida de percepci√≥n y opini√≥n ciudadana',
      escala: EscalaType.PROYECTO,
      unidad: UnidadType.NUMERO,
      origen_calculo: 'N√∫mero de procesos formales de consulta y recogida de opini√≥n implementados',
      objetivos_2025: 'Realizar 4 procesos anuales de consulta ciudadana',
      observaciones: 'Incluye encuestas, buzones de sugerencias, plataformas online, grupos focales',
      proyecto_id: proyecto.id,
    },
    {
      codigo: 'C-105',
      categoria_prefijo: CategoriaPrefijo.C,
      indicador: '√ìrganos permanentes creados a partir de las entidades implicadas en el proyecto',
      escala: EscalaType.PROYECTO,
      unidad: UnidadType.NUMERO,
      origen_calculo: 'N√∫mero de comisiones, consejos u √≥rganos estables de gesti√≥n creados',
      objetivos_2025: 'Crear 2 √≥rganos permanentes de seguimiento y gesti√≥n',
      observaciones: 'Ej: Comisi√≥n Verde Municipal, Consejo Participativo de Biodiversidad',
      proyecto_id: proyecto.id,
    },
    {
      codigo: 'C-106',
      categoria_prefijo: CategoriaPrefijo.C,
      indicador: 'Sistemas regulatorios creados',
      escala: EscalaType.PROYECTO,
      unidad: UnidadType.NUMERO,
      origen_calculo: 'N√∫mero de normativas, ordenanzas o reglamentos aprobados vinculados al proyecto',
      objetivos_2025: 'Aprobar 3 sistemas regulatorios para conservaci√≥n urbana',
      observaciones: 'Incluye ordenanzas de arbolado, normativas de jardines, reglamentos de uso',
      proyecto_id: proyecto.id,
    },
    {
      codigo: 'C-107',
      categoria_prefijo: CategoriaPrefijo.C,
      indicador: 'Mecanismos incentivadores creados',
      escala: EscalaType.PROYECTO,
      unidad: UnidadType.NUMERO,
      origen_calculo: 'N√∫mero de incentivos econ√≥micos o fiscales establecidos para promocionar naturalizaci√≥n',
      objetivos_2025: 'Establecer 4 mecanismos de incentivo para ciudadanos y empresas',
      observaciones: 'Ej: bonificaciones IBI, subvenciones cubiertas verdes, premios jardines sostenibles',
      proyecto_id: proyecto.id,
    },
    {
      codigo: 'C-108',
      categoria_prefijo: CategoriaPrefijo.C,
      indicador: 'Transparencia en el proceso',
      escala: EscalaType.PROYECTO,
      unidad: UnidadType.SI_NO,
      origen_calculo: 'Existencia de portal web p√∫blico con informaci√≥n completa y actualizada del proyecto',
      objetivos_2025: 'Mantener transparencia total con informaci√≥n p√∫blica accesible',
      observaciones: 'Portal debe incluir presupuestos, cronogramas, resultados, participaci√≥n ciudadana',
      proyecto_id: proyecto.id,
    },
    {
      codigo: 'C-109',
      categoria_prefijo: CategoriaPrefijo.C,
      indicador: 'Alianzas y colaboraciones internacionales',
      escala: EscalaType.PROYECTO,
      unidad: UnidadType.NUMERO,
      origen_calculo: 'N√∫mero de colaboraciones con proyectos, ciudades o organismos internacionales',
      objetivos_2025: 'Establecer 3 alianzas internacionales de intercambio de experiencias',
      observaciones: 'Incluye hermanamientos, redes de ciudades, proyectos europeos, intercambios t√©cnicos',
      proyecto_id: proyecto.id,
    },
    {
      codigo: 'C-110',
      categoria_prefijo: CategoriaPrefijo.C,
      indicador: 'Fondos p√∫blicos y privados movilizados para la renaturalizaci√≥n',
      escala: EscalaType.PROYECTO,
      unidad: UnidadType.EURO,
      origen_calculo: 'Valor econ√≥mico total de fondos adicionales conseguidos gracias al proyecto',
      objetivos_2025: 'Movilizar 400.000‚Ç¨ adicionales en cofinanciaci√≥n y fondos complementarios',
      observaciones: 'Incluye fondos europeos, patrocinios privados, crowdfunding, donaciones',
      proyecto_id: proyecto.id,
    },

    // COMUNICACI√ìN Y SENSIBILIZACI√ìN (C-201 a C-211)
    {
      codigo: 'C-201',
      categoria_prefijo: CategoriaPrefijo.C,
      indicador: 'Difusi√≥n general del proyecto en medios',
      escala: EscalaType.PROYECTO,
      unidad: UnidadType.NUMERO,
      origen_calculo: 'N√∫mero de apariciones en medios de comunicaci√≥n (prensa, radio, TV)',
      objetivos_2025: 'Conseguir 50 apariciones anuales en medios de comunicaci√≥n',
      observaciones: 'Incluye noticias, reportajes, entrevistas en medios locales, regionales y nacionales',
      proyecto_id: proyecto.id,
    },
    {
      codigo: 'C-202',
      categoria_prefijo: CategoriaPrefijo.C,
      indicador: 'Difusi√≥n general del proyecto en redes sociales',
      escala: EscalaType.PROYECTO,
      unidad: UnidadType.NUMERO,
      origen_calculo: 'N√∫mero de publicaciones sobre el proyecto en redes sociales institucionales',
      objetivos_2025: 'Realizar 200 publicaciones anuales en redes sociales',
      observaciones: 'Incluye posts Facebook, tweets, Instagram, LinkedIn con alcance y engagement medidos',
      proyecto_id: proyecto.id,
    },
    {
      codigo: 'C-203',
      categoria_prefijo: CategoriaPrefijo.C,
      indicador: 'Difusi√≥n general del proyecto en la web municipal',
      escala: EscalaType.PROYECTO,
      unidad: UnidadType.NUMERO,
      origen_calculo: 'N√∫mero de contenidos publicados en web municipal sobre avances del proyecto',
      objetivos_2025: 'Publicar 24 contenidos anuales (2 mensuales) en web municipal',
      observaciones: 'Incluye noticias, galer√≠a fotos, informes de seguimiento, eventos',
      proyecto_id: proyecto.id,
    },
    {
      codigo: 'C-204',
      categoria_prefijo: CategoriaPrefijo.C,
      indicador: 'Divulgaci√≥n de los contenidos del proyecto',
      escala: EscalaType.PROYECTO,
      unidad: UnidadType.NUMERO,
      origen_calculo: 'N√∫mero de materiales divulgativos espec√≠ficos creados (folletos, v√≠deos, infograf√≠as)',
      objetivos_2025: 'Crear 15 materiales divulgativos especializados',
      observaciones: 'Incluye folletos t√©cnicos, v√≠deos explicativos, infograf√≠as, presentaciones',
      proyecto_id: proyecto.id,
    },
    {
      codigo: 'C-205',
      categoria_prefijo: CategoriaPrefijo.C,
      indicador: 'Divulgaci√≥n y sensibilizaci√≥n general presencial',
      escala: EscalaType.PROYECTO,
      unidad: UnidadType.NUMERO,
      origen_calculo: 'N√∫mero de eventos presenciales de divulgaci√≥n realizados',
      objetivos_2025: 'Organizar 12 eventos anuales de sensibilizaci√≥n presencial',
      observaciones: 'Incluye charlas, talleres, jornadas, ferias, exposiciones, rutas guiadas',
      proyecto_id: proyecto.id,
    },
    {
      codigo: 'C-206',
      categoria_prefijo: CategoriaPrefijo.C,
      indicador: 'Difusi√≥n especializada del proyecto en medios',
      escala: EscalaType.PROYECTO,
      unidad: UnidadType.NUMERO,
      origen_calculo: 'N√∫mero de apariciones en medios especializados (revistas t√©cnicas, congresos)',
      objetivos_2025: 'Conseguir 8 apariciones anuales en medios especializados',
      observaciones: 'Incluye revistas cient√≠ficas, boletines t√©cnicos, conferencias especializadas',
      proyecto_id: proyecto.id,
    },
    {
      codigo: 'C-207',
      categoria_prefijo: CategoriaPrefijo.C,
      indicador: 'Formaci√≥n y capacitaci√≥n en el √°mbito de la renaturalizaci√≥n',
      escala: EscalaType.PROYECTO,
      unidad: UnidadType.NUMERO,
      origen_calculo: 'N√∫mero de cursos, talleres o programas formativos espec√≠ficos impartidos',
      objetivos_2025: 'Impartir 6 cursos anuales de capacitaci√≥n t√©cnica',
      observaciones: 'Incluye cursos para t√©cnicos municipales, jardineros, ciudadanos, escolares',
      proyecto_id: proyecto.id,
    },
    {
      codigo: 'C-208',
      categoria_prefijo: CategoriaPrefijo.C,
      indicador: 'Contribuci√≥n de las plataformas de ciencia ciudadana al conocimiento de la biodiversidad',
      escala: EscalaType.PROYECTO,
      unidad: UnidadType.NUMERO,
      origen_calculo: 'N√∫mero de registros de biodiversidad aportados por ciudadanos a plataformas cient√≠ficas',
      objetivos_2025: 'Conseguir 500 registros anuales de ciencia ciudadana',
      observaciones: 'Incluye eBird, iNaturalist, Biodiversidad Virtual, proyectos de seguimiento',
      proyecto_id: proyecto.id,
    },
    {
      codigo: 'C-209',
      categoria_prefijo: CategoriaPrefijo.C,
      indicador: 'Percepci√≥n ciudadana ante la naturalizaci√≥n',
      escala: EscalaType.PROYECTO,
      unidad: UnidadType.NUMERO,
      origen_calculo: 'N√∫mero de estudios de percepci√≥n ciudadana realizados sobre renaturalizaci√≥n urbana',
      objetivos_2025: 'Realizar 2 estudios anuales de percepci√≥n ciudadana',
      observaciones: 'Incluye encuestas espec√≠ficas, grupos focales, estudios sociol√≥gicos sobre aceptaci√≥n',
      proyecto_id: proyecto.id,
    },
    {
      codigo: 'C-210',
      categoria_prefijo: CategoriaPrefijo.C,
      indicador: 'Transferencia de conocimiento',
      escala: EscalaType.PROYECTO,
      unidad: UnidadType.NUMERO,
      origen_calculo: 'N√∫mero de acciones de transferencia a otros municipios o entidades',
      objetivos_2025: 'Realizar 8 acciones anuales de transferencia de conocimiento',
      observaciones: 'Incluye visitas t√©cnicas, intercambios, asesor√≠as, publicaciones metodol√≥gicas',
      proyecto_id: proyecto.id,
    },
    {
      codigo: 'C-211',
      categoria_prefijo: CategoriaPrefijo.C,
      indicador: 'Participaci√≥n en actividades programadas durante la ejecuci√≥n del proyecto',
      escala: EscalaType.PROYECTO,
      unidad: UnidadType.NUMERO,
      origen_calculo: 'N√∫mero total de participantes en todas las actividades programadas del proyecto',
      objetivos_2025: 'Conseguir 3.000 participaciones anuales en actividades del proyecto',
      observaciones: 'Suma de asistentes a talleres, eventos, jornadas, voluntariados (una persona puede contar varias veces)',
      proyecto_id: proyecto.id,
    },

    // MEDICI√ìN Y SEGUIMIENTO (C-301 a C-303)
    {
      codigo: 'C-301',
      categoria_prefijo: CategoriaPrefijo.C,
      indicador: 'Seguimiento de informes',
      escala: EscalaType.PROYECTO,
      unidad: UnidadType.NUMERO,
      origen_calculo: 'N√∫mero de informes de seguimiento t√©cnico elaborados y publicados',
      objetivos_2025: 'Elaborar 4 informes anuales de seguimiento t√©cnico completo',
      observaciones: 'Incluye informes trimestrales de avance, evaluaci√≥n intermedia, informe final',
      proyecto_id: proyecto.id,
    },
    {
      codigo: 'C-302',
      categoria_prefijo: CategoriaPrefijo.C,
      indicador: 'Evaluaci√≥n de impacto',
      escala: EscalaType.PROYECTO,
      unidad: UnidadType.NUMERO,
      origen_calculo: 'N√∫mero de evaluaciones de impacto ambiental y social realizadas',
      objetivos_2025: 'Realizar 2 evaluaciones de impacto completas durante el proyecto',
      observaciones: 'Incluye evaluaci√≥n inicial, intermedia y final con metodolog√≠a estandarizada',
      proyecto_id: proyecto.id,
    },
    {
      codigo: 'C-303',
      categoria_prefijo: CategoriaPrefijo.C,
      indicador: 'Gesti√≥n adaptativa',
      escala: EscalaType.PROYECTO,
      unidad: UnidadType.NUMERO,
      origen_calculo: 'N√∫mero de adaptaciones o mejoras implementadas basadas en seguimiento y evaluaci√≥n',
      objetivos_2025: 'Implementar 6 mejoras adaptativas basadas en seguimiento',
      observaciones: 'Incluye cambios de dise√±o, nuevas especies, modificaciones de mantenimiento',
      proyecto_id: proyecto.id,
    },
  ];

  console.log('üìù Creando indicadores C...');

  // Crear cada indicador C
  for (const indicadorData of indicadoresC) {
    console.log(`   ‚Üí Creando ${indicadorData.codigo}: ${indicadorData.indicador}`);
    
    const indicador = await prisma.indicadorGeneral.create({
      data: indicadorData,
    });

    // Crear valores de ejemplo realistas para cada indicador
    const valoresEjemplo = {
      'C-101': { base: 3, intermedio: 6, final: 9, obs: 'Coordinaci√≥n: Ayuntamiento + Comunidad Madrid + Diputaci√≥n + MITECO + CHT + AEMET + Fundaci√≥n Biodiversidad + SEO/BirdLife + Universidad' },
      'C-102': { base: 5, intermedio: 11, final: 16, obs: 'Agentes: 4 asociaciones vecinales + 3 centros educativos + 2 empresas locales + 4 ONGs + 3 entidades culturales' },
      'C-103': { base: 85, intermedio: 280, final: 520, obs: 'Participaci√≥n creciente: talleres participativos + voluntariado ambiental + asambleas de seguimiento' },
      'C-104': { base: 1, intermedio: 3, final: 4, obs: 'Consultas: encuesta inicial + buz√≥n sugerencias + plataforma digital + grupos focales' },
      'C-105': { base: 0, intermedio: 1, final: 2, obs: '√ìrganos creados: Comisi√≥n Verde Municipal + Consejo Participativo Biodiversidad' },
      'C-106': { base: 1, intermedio: 2, final: 3, obs: 'Normativa: Ordenanza Arbolado + Reglamento Huertos + Normativa Jardines Privados' },
      'C-107': { base: 0, intermedio: 2, final: 4, obs: 'Incentivos: Bonificaci√≥n IBI cubiertas verdes + Subvenci√≥n jardines + Premio huerto sostenible + Ayuda compostaje' },
      'C-108': { base: 1, intermedio: 1, final: 1, obs: 'Portal transparencia activo: presupuestos + cronograma + resultados + participaci√≥n' },
      'C-109': { base: 0, intermedio: 1, final: 3, obs: 'Alianzas: Red Ciudades Sostenibles + Proyecto LIFE+ europeo + Intercambio Portugal' },
      'C-110': { base: 25000, intermedio: 180000, final: 425000, obs: 'Fondos movilizados: LIFE+ (200k) + Patrocinio Caja Rural (50k) + Diputaci√≥n (100k) + Crowdfunding (75k)' },
      'C-201': { base: 8, intermedio: 28, final: 52, obs: 'Medios: prensa local (30) + radio regional (12) + TV auton√≥mica (6) + prensa nacional (4)' },
      'C-202': { base: 24, intermedio: 110, final: 205, obs: 'RRSS: Facebook (80) + Instagram (60) + Twitter (45) + LinkedIn (20) publicaciones anuales' },
      'C-203': { base: 6, intermedio: 15, final: 26, obs: 'Web municipal: noticias mensuales + galer√≠a trimestral + informes semestrales' },
      'C-204': { base: 3, intermedio: 9, final: 16, obs: 'Materiales: 5 folletos + 4 v√≠deos + 3 infograf√≠as + 2 presentaciones + 2 exposiciones' },
      'C-205': { base: 2, intermedio: 7, final: 13, obs: 'Eventos: talleres familiares + charlas escolares + jornadas t√©cnicas + rutas guiadas + ferias' },
      'C-206': { base: 1, intermedio: 4, final: 8, obs: 'Medios especializados: Revista Quercus + Congreso CONAMA + Bolet√≠n REDRURAL + Ecosostenible' },
      'C-207': { base: 1, intermedio: 3, final: 6, obs: 'Formaci√≥n: Curso jardiner√≠a ecol√≥gica + Taller compostaje + Capacitaci√≥n t√©cnicos + Escuela sostenibilidad' },
      'C-208': { base: 45, intermedio: 220, final: 515, obs: 'Ciencia ciudadana: iNaturalist (300) + eBird (150) + Biodiversidad Virtual (65) registros' },
      'C-209': { base: 1, intermedio: 1, final: 2, obs: 'Estudios percepci√≥n: Encuesta inicial + Estudio sociol√≥gico final sobre aceptaci√≥n social' },
      'C-210': { base: 2, intermedio: 5, final: 8, obs: 'Transferencia: Visitas Alcal√° + Asesor√≠a Aranjuez + Intercambio Legan√©s + Metodolog√≠a publicada' },
      'C-211': { base: 180, intermedio: 1200, final: 3150, obs: 'Participaci√≥n total: suma asistentes talleres + eventos + voluntariado + actividades escolares' },
      'C-301': { base: 1, intermedio: 2, final: 4, obs: 'Informes: 4 informes trimestrales + evaluaci√≥n intermedia + informe final' },
      'C-302': { base: 1, intermedio: 1, final: 2, obs: 'Evaluaciones: Evaluaci√≥n inicial LCA + Evaluaci√≥n final impacto social y ambiental' },
      'C-303': { base: 0, intermedio: 3, final: 7, obs: 'Adaptaciones: cambio especies secas + mejora riego + nuevo sistema compostaje + se√±alizaci√≥n' },
    };

    const valores = valoresEjemplo[indicadorData.codigo as keyof typeof valoresEjemplo];

    await prisma.valorIndicadorGeneral.create({
      data: {
        valor_linea_base: valores.base,
        valor_intermedio: valores.intermedio,
        valor_final: valores.final,
        fecha_medicion: new Date('2024-07-07'),
        observaciones: valores.obs,
        indicador_general_id: indicador.id,
      },
    });

    console.log(`   ‚úÖ ${indicadorData.codigo} creado con valores de ejemplo`);
  }

  console.log('üéâ ¬°INDICADORES C IMPLEMENTADOS EXITOSAMENTE - 100% COMPLETADO!');
  console.log(`üìä Resumen:`);
  console.log(`   ‚Ä¢ ${indicadoresC.length} Indicadores de Comunicaci√≥n y Gobernanza (C) creados`);
  console.log(`   ‚Ä¢ ${indicadoresC.length} Conjuntos de valores de ejemplo`);
  console.log(`   ‚Ä¢ Proyecto asociado: ${proyecto.nombre}`);
  console.log('');
  console.log('üîç Indicadores creados:');
  indicadoresC.forEach((ind, index) => {
    console.log(`   ${index + 1}. ${ind.codigo} - ${ind.indicador}`);
  });
  console.log('');
  console.log('üèÜ ¬°FELICIDADES! TODOS LOS INDICADORES DE LA FUNDACI√ìN BIODIVERSIDAD HAN SIDO IMPLEMENTADOS');
}

main()
  .catch((e) => {
    console.error('‚ùå Error al implementar indicadores C:', e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });